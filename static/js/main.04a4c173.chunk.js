(this["webpackJsonppost-reader"]=this["webpackJsonppost-reader"]||[]).push([[0],{15:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n(9),s=n.n(c),a=n(2),i=(n(15),n(3)),u=n.n(i),o=n(4),l=function(e,t){var n=new URLSearchParams({email:e,name:t,client_id:"ju16a6m81mhid5ue1z3v2g0uh"});return fetch("https://api.supermetrics.com/assignment/register",{method:"POST",body:n})},j=n(0),d=function(e){var t=e.setToken,n=Object(r.useState)("idle"),c=Object(a.a)(n,2),s=c[0],i=c[1],d=Object(r.useState)(""),b=Object(a.a)(d,2),O=b[0],f=b[1],m=Object(r.useState)(""),p=Object(a.a)(m,2),h=p[0],v=p[1],x=function(){var e=Object(o.a)(u.a.mark((function e(n){var r,c,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i("pending"),n.preventDefault(),e.prev=2,e.next=5,l(h,O);case 5:return r=e.sent,e.next=8,r.json();case 8:c=e.sent,s=c.data.sl_token,t(s),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),i("rejected");case 16:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t){return e.apply(this,arguments)}}();return"pending"===s?"Logging in . . .":"rejected"===s?"Something went wrong":Object(j.jsx)("div",{className:"login",children:Object(j.jsxs)("form",{onSubmit:x,className:"login_form",children:[Object(j.jsx)("h1",{children:"Login"}),Object(j.jsxs)("div",{className:"login_field",children:[Object(j.jsx)("label",{htmlFor:"name",children:"Name"}),Object(j.jsx)("input",{type:"text",value:O,onChange:function(e){return f(e.target.value)},required:!0})]}),Object(j.jsxs)("div",{className:"login_field",children:[Object(j.jsx)("label",{htmlFor:"email",children:"Email"}),Object(j.jsx)("input",{type:"email",value:h,onChange:function(e){return v(e.target.value)},required:!0})]}),Object(j.jsx)("button",{type:"submit",className:"login_button",children:"Go"})]})})},b=n(5),O=n(10),f=function(e){var t=e.userPosts,n=e.currentUserId,c=Object(r.useState)(""),s=Object(a.a)(c,2),i=s[0],u=s[1],o=Object(r.useState)([]),l=Object(a.a)(o,2),d=l[0],O=l[1];Object(r.useEffect)((function(){var e;O(null===(e=t[n])||void 0===e?void 0:e.posts.filter((function(e){return e.message.toLocaleLowerCase().includes(i.toLocaleLowerCase())})))}),[i,n,t]);return Object(j.jsx)("div",{className:"container",children:Object(j.jsxs)("div",{className:"right_box",children:[Object(j.jsxs)("div",{className:"top_bar",children:[Object(j.jsxs)("div",{children:[Object(j.jsx)("button",{onClick:function(){var e=t[n].posts.sort((function(e,t){return new Date(e.created_time).valueOf()<new Date(t.created_time).valueOf()?1:-1}));O(Object(b.a)(e))},children:Object(j.jsx)("i",{className:"fa fa-toggle-up"})}),Object(j.jsx)("button",{onClick:function(){var e=t[n].posts.sort((function(e,t){return new Date(e.created_time).valueOf()>new Date(t.created_time).valueOf()?1:-1}));O(Object(b.a)(e))},children:Object(j.jsx)("i",{className:"fa fa-toggle-down"})})]}),Object(j.jsx)("input",{type:"text",placeholder:"Search Posts...",onChange:function(e){u(e.target.value)}})]}),Object(j.jsx)("div",{className:"posts_lists",children:d.map((function(e){return Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:new Date(e.created_time).toDateString()}),Object(j.jsx)("li",{children:e.message})]},e.id)}))})]})})},m=function(e){var t=e.users,n=e.changeCurrentUserId,c=e.currentUserId,s=e.userPosts,i=Object(r.useState)(""),u=Object(a.a)(i,2),o=u[0],l=u[1],d=Object(r.useState)([]),b=Object(a.a)(d,2),O=b[0],f=b[1];return Object(r.useEffect)((function(){f(null===t||void 0===t?void 0:t.filter((function(e){return e.userName.toLocaleLowerCase().includes(o.toLocaleLowerCase())})))}),[o,t]),Object(j.jsx)("div",{className:"container",children:Object(j.jsxs)("div",{className:"left_box",children:[Object(j.jsx)("input",{type:"text",placeholder:"Search Users...",onChange:function(e){l(e.target.value)}}),Object(j.jsx)("ul",{children:null===O||void 0===O?void 0:O.sort((function(e,t){return e.userName>t.userName?1:-1})).map((function(e){var t,r;return Object(j.jsx)("li",{children:Object(j.jsxs)("button",{onClick:n(e.userId),className:c===e.userId?"active":"",children:[e.userName,"\n",Object(j.jsx)("span",{children:null===(t=s[e.userId])||void 0===t||null===(r=t.posts)||void 0===r?void 0:r.length})]})},e.userId)}))})]})})},p=function(){var e=Object(o.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("https://api.supermetrics.com/assignment/posts","?sl_token=").concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=["from_id","from_name"],v=function(e){var t=e.token,n=Object(r.useState)("idle"),c=Object(a.a)(n,2),s=c[0],i=c[1],l=Object(r.useState)([]),d=Object(a.a)(l,2),v=d[0],x=d[1],g=Object(r.useState)([]),_=Object(a.a)(g,2),w=_[0],N=_[1],S=Object(r.useState)("user_0"),k=Object(a.a)(S,2),C=k[0],I=k[1];return Object(r.useEffect)((function(){var e=function(){var e=Object(o.a)(u.a.mark((function e(){var n,r,c,s,a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i("pending"),e.next=3,p(t);case 3:return n=e.sent,e.next=6,n.json();case 6:r=e.sent,c=r.data.posts,s=c.reduce((function(e,t){var n,r=t.from_id,c=t.from_name,s=Object(O.a)(t,h),a=(null===(n=e[t.from_id])||void 0===n?void 0:n.posts)||[];return e[t.from_id]={from_id:r,from_name:c,posts:[].concat(Object(b.a)(a),[s])},e}),{}),a=Object.keys(s),o=a.reduce((function(e,t){var n={userId:t,userName:s[t].from_name};return e=[].concat(Object(b.a)(e),[n])}),[]),N(s),x(o),i("idle");case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[t]),"pending"===s?"Fetching posts . . .":Object(j.jsxs)("div",{children:[Object(j.jsx)(m,{users:v,changeCurrentUserId:function(e){return function(){return I(e)}},currentUserId:C,userPosts:w}),Object(j.jsx)(f,{userPosts:w,currentUserId:C})]})};var x=function(){var e=Object(r.useState)(""),t=Object(a.a)(e,2),n=t[0],c=t[1];return Object(j.jsx)("div",{children:n?Object(j.jsx)(v,{token:n}):Object(j.jsx)(d,{setToken:c})})};s.a.render(Object(j.jsx)(x,{}),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.04a4c173.chunk.js.map